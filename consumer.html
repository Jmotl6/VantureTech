<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vanture — Consumer Demo</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.js"></script>
  <!-- Leaflet for demo map (works without MapKit tokens) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="logo" id="logoWrap">
        <img id="companyLogo" alt="Company logo" src="" style="display:none;max-height:36px;" />
        <span id="logoText">VANTURE</span>
      </a>

      <nav class="site-nav" id="site-nav" aria-label="Primary">
        <a class="nav-link" href="index.html">Home</a>
        <a class="nav-link" href="index.html#features">Features</a>
        <a class="nav-link" href="index.html#pricing">Pricing</a>
        <a class="nav-link" href="index.html#reserve">Reserve</a>
        <div class="nav-dropdown">
          <button class="nav-link dropdown-toggle" id="demoToggle">Demo ▾</button>
          <div class="dropdown-menu" aria-hidden="true">
            <a class="dropdown-item" href="business.html">Business</a>
          </div>
        </div>
      </nav>

      <div class="header-actions">
        <label class="ui-switch" title="Toggle light mode">
          <input id="modeSwitch" type="checkbox" aria-label="Toggle light mode">
          <div class="slider"><div class="switch-circle"></div></div>
        </label>
        <button id="openCartBtn" class="btn" aria-label="Open cart" title="Cart" aria-haspopup="dialog" style="position:relative;margin-left:.6rem">
          🛒 <span id="cartCountBadge" class="cart-badge" aria-hidden="false">0</span>
        </button>
        <button class="hamburger" id="hamburger" aria-label="Open menu" aria-expanded="false">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
  </header>

  <main>
    <section class="hero hero--parallax reveal-on-scroll">
      <div class="container hero-inner reveal-stagger">
        <h1 class="hero-title">Discover mobile vendors near you</h1>
        <p class="hero-sub">Find food trucks and mobile vendors in your area — demo only.</p>
        <div class="hero-ctas">
          <a class="btn btn-primary" href="#search">Find Vendors</a>
          <button id="openMenuBtn" class="btn btn-primary" aria-haspopup="dialog" aria-controls="menuModal">View Menu</button>
        </div>
      </div>
    </section>

    <section id="search" class="features reveal-on-scroll">
      <div class="container">
        <h2 class="section-title">Search</h2>
        <p class="section-sub">Demo.</p>

        <div class="search-demo">
          <div class="search-input-wrap">
            <input id="demoSearchInput" class="demo-search" placeholder="Enter city or ZIP or address" aria-label="Search vendors by city or ZIP" />
            <div class="search-actions">
              <button class="btn btn-search" id="demoSearchBtn">Search</button>
              <button class="btn" id="demoSearchClear" title="Clear search">Clear</button>
            </div>
          </div>
          <div id="searchResult" class="search-result" aria-live="polite">Type a city or ZIP and press Enter or click Search.</div>
        </div>

        <div class="vendors-grid reveal-stagger" id="vendorsGrid">
          <!-- Vendor cards populated in HTML for demo -->
          <!-- Expanded vendor list -->
          <article class="vendor-card" data-id="v1" data-lat="37.7749" data-lon="-122.4194" role="article" aria-label="Tom's Tacos" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck1.jpg" alt="Tom's Tacos" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Tom's+Tacos" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Tom's Tacos</div>
                <div class="card-description">Fresh tacos, daily specials.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★☆</span><span class="distance">• 0.6 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v2" data-lat="37.7849" data-lon="-122.4094" role="article" aria-label="Sally's Sandwiches" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck2.jpg" alt="Sally's Sandwiches" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Sally's+Sandwiches" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Sally's Sandwiches</div>
                <div class="card-description">Gourmet sandwiches on the go.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★★</span><span class="distance">• 0.3 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v3" data-lat="37.7649" data-lon="-122.4294" role="article" aria-label="Bella Pizza" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck3.jpg" alt="Bella Pizza" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Bella+Pizza" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Bella Pizza</div>
                <div class="card-description">Wood-fired slices and whole pies.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★☆☆</span><span class="distance">• 1.2 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v4" data-lat="37.7725" data-lon="-122.4148" role="article" aria-label="Luna Bowls" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck4.jpg" alt="Luna Bowls" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Luna+Bowls" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Luna Bowls</div>
                <div class="card-description">Healthy grain bowls and smoothies.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★☆</span><span class="distance">• 0.9 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v5" data-lat="37.7701" data-lon="-122.4230" role="article" aria-label="The Crepe Cart" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck5.jpg" alt="The Crepe Cart" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Crepe+Cart" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">The Crepe Cart</div>
                <div class="card-description">Savory and sweet crepes.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★★</span><span class="distance">• 0.4 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v6" data-lat="37.7682" data-lon="-122.4350" role="article" aria-label="Green Curry Truck" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck6.jpg" alt="Green Curry Truck" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Green+Curry" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Green Curry Truck</div>
                <div class="card-description">Authentic Thai street food.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★☆</span><span class="distance">• 1.1 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v7" data-lat="37.7790" data-lon="-122.4180" role="article" aria-label="Burger Lab" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck7.jpg" alt="Burger Lab" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Burger+Lab" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Burger Lab</div>
                <div class="card-description">Artisan burgers and fries.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★☆☆</span><span class="distance">• 2.0 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v8" data-lat="37.7765" data-lon="-122.4125" role="article" aria-label="Sweet Rolls" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck8.jpg" alt="Sweet Rolls" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Sweet+Rolls" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Sweet Rolls</div>
                <div class="card-description">Fresh baked pastries and coffee.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★☆</span><span class="distance">• 0.8 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            <!doctype html>
            <html lang="en">
            <head>
              <meta charset="utf-8" />
              <meta name="viewport" content="width=device-width, initial-scale=1" />
              <title>Vanture  Consumer Demo</title>
              <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
              <link rel="stylesheet" href="style.css">
              <style>
                :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#0b66ff;--accent-2:#2563eb;--glass:rgba(255,255,255,0.04)}
                html,body{height:100%;font-family:Inter,system-ui,Arial,Helvetica,sans-serif;background:linear-gradient(180deg,#061025 0%,#071627 60%);color:#e6eef6;margin:0}
                .container{max-width:1100px;margin:0 auto;padding:1rem}
                .site-header{padding:.8rem 0}
                .header-inner{display:flex;align-items:center;justify-content:space-between}
                .logo{font-weight:700;letter-spacing:2px;color:var(--accent)}
                .hero{padding:2rem 0}
                .hero-title{font-size:2rem;margin:.2rem 0}
                .vendors-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;margin:1.25rem 0}
                .vendor-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;overflow:hidden;cursor:pointer;transition:transform .16s ease,box-shadow .16s}
                .vendor-card:focus,.vendor-card:hover{transform:translateY(-6px);box-shadow:0 8px 30px rgba(2,6,23,0.6);outline:2px solid rgba(11,102,255,0.12)}
                .vendor-card .thumb{height:140px;width:100%;object-fit:cover;display:block}
                .vendor-info{padding:.8rem}
                .vendor-title{font-weight:600;margin-bottom:.25rem}
                .vendor-desc{color:var(--muted);font-size:.95rem}

                /* Centered modal (menu) */
                .overlay{position:fixed;inset:0;background:linear-gradient(180deg,rgba(2,6,23,0.6),rgba(2,6,23,0.75));display:none;align-items:center;justify-content:center;z-index:160}
                .overlay[data-open="true"]{display:flex}
                .menu-card{background:linear-gradient(180deg,#061424, #07192b);width:min(920px,96%);max-height:88vh;border-radius:14px;box-shadow:0 20px 60px rgba(3,8,20,0.7);overflow:hidden;display:grid;grid-template-columns:1fr 320px}
                .menu-left{padding:1rem 1rem;overflow:auto}
                .menu-right{background:linear-gradient(180deg,rgba(6,12,30,0.3),transparent);padding:1rem;border-left:1px solid rgba(255,255,255,0.03)}
                .vendor-header{display:flex;gap:12px;align-items:center}
                .vendor-header img{width:72px;height:72px;border-radius:10px;object-fit:cover}
                .menu-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:.8rem;margin-top:1rem}
                .item-card{background:var(--glass);padding:.6rem;border-radius:10px;display:flex;gap:.6rem;align-items:center}
                .item-meta{flex:1}
                .item-name{font-weight:600}
                .item-desc{color:var(--muted);font-size:.9rem}
                .item-price{font-weight:700;color:var(--accent-2)}

                /* Cart right column */
                .cart-summary{display:flex;flex-direction:column;gap:.6rem}
                .cart-items{min-height:120px;overflow:auto;padding:.25rem;border-radius:8px;background:rgba(0,0,0,0.04)}
                .cart-row{display:flex;justify-content:space-between;gap:.6rem;padding:.45rem 0;border-bottom:1px dashed rgba(255,255,255,0.02)}
                .cart-total{font-weight:700;font-size:1.05rem}
                .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:inherit;padding:.45rem .65rem;border-radius:8px;cursor:pointer}
                .btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:0;color:white}

                /* Item editor modal */
                .sheet{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#071427;border-radius:12px;padding:1rem;z-index:200;min-width:320px;display:none}
                .sheet[aria-hidden="false"]{display:block}

                @media(max-width:900px){.menu-card{grid-template-columns:1fr}.menu-right{display:none}}
              </style>
            </head>
            <body>
              <header class="site-header">
                <div class="container header-inner">
                  <a class="logo" href="index.html">VANTURE</a>
                  <div style="display:flex;gap:.6rem;align-items:center">
                    <button id="openCartBtn" class="btn" aria-haspopup="dialog" title="Open cart"> <span id="cartCount">0</span></button>
                    <button id="openVendorsBtn" class="btn btn-primary">Browse Vendors</button>
                  </div>
                </div>
              </header>

              <main>
                <section class="container hero">
                  <h1 class="hero-title">Find local mobile vendors  modern demo</h1>
                  <p class="hero-sub">Click a vendor to open its menu. Keyboard accessible. Blue accents.</p>
                </section>

                <section class="container" aria-label="Vendors">
                  <div class="vendors-grid" id="vendorsGrid"></div>
                </section>
              </main>

              <!-- Centered Menu Overlay -->
              <div class="overlay" id="menuOverlay" aria-hidden="true" role="dialog" aria-modal="true">
                <div class="menu-card" role="document" aria-labelledby="menuTitle">
                  <div class="menu-left" id="menuLeft">
                    <div class="vendor-header">
                      <img id="menuVendorThumb" src="https://via.placeholder.com/160x160?text=V" alt="Vendor" />
                      <div>
                        <div id="menuVendorName" style="font-weight:700">Vendor</div>
                        <div id="menuVendorDesc" style="color:var(--muted)">Open now  0.4 mi</div>
                      </div>
                    </div>
                    <div class="menu-list" id="menuList" tabindex="0"></div>
                  </div>
                  <aside class="menu-right" id="menuRight">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                      <strong>Your Cart</strong>
                      <button id="closeMenuBtn" class="btn" aria-label="Close menu">Close</button>
                    </div>
                    <div class="cart-summary">
                      <div class="cart-items" id="cartItems">No items yet.</div>
                      <div style="display:flex;flex-direction:column;gap:.4rem;margin-top:.6rem">
                        <div style="display:flex;justify-content:space-between"><span>Subtotal</span><span id="cartSubtotal">$0.00</span></div>
                        <div style="display:flex;justify-content:space-between"><span>Tax</span><span id="cartTax">$0.00</span></div>
                        <div style="display:flex;justify-content:space-between" class="cart-total"><span>Total</span><span id="cartTotal">$0.00</span></div>
                        <div style="display:flex;gap:.5rem;margin-top:.6rem">
                          <button id="checkoutBtn" class="btn btn-primary">Checkout</button>
                          <button id="clearCartBtn" class="btn">Clear</button>
                        </div>
                      </div>
                    </div>
                  </aside>
                </div>
              </div>

              <!-- Item customization sheet -->
              <div class="sheet" id="itemSheet" aria-hidden="true" role="dialog">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.6rem">
                  <strong id="itemSheetTitle">Customize</strong>
                  <button id="itemSheetClose" class="btn">Close</button>
                </div>
                <div id="itemSheetBody"></div>
                <div style="display:flex;gap:.5rem;margin-top:.6rem"><button id="addItemBtn" class="btn btn-primary">Add to Cart</button></div>
              </div>

              <script>
              (function(){
                // Minimal demo data  in real app load from server
                const VENDORS = [
                  {id:'v1',name:"Tom's Tacos",desc:'Fresh tacos & specials',thumb:'images/truck1.jpg',menu:[{id:'t1',name:'Street Taco',desc:'Corn tortilla, meat, salsa',price:3.5,limit:10},{id:'t2',name:'Burrito',desc:'Large flour tortilla',price:8.0,limit:5}]},
                  {id:'v2',name:'Sally Sandwiches',desc:'Quick handhelds',thumb:'images/truck2.jpg',menu:[{id:'s1',name:'BLT',desc:'Bacon, lettuce, tomato',price:6.5,limit:6},{id:'s2',name:'Veg Wrap',desc:'Seasonal veggies',price:7.0,limit:8}]},
                  {id:'v3',name:'Cup & Cake',desc:'Coffee and sweets',thumb:'images/truck3.jpg',menu:[{id:'c1',name:'Latte',desc:'Oat milk option',price:4.0,limit:20},{id:'c2',name:'Cupcake',desc:'Rotating flavors',price:3.25,limit:12}]}
                ];

                // State
                let currentVendor = null;
                const cart = {vendorId:null,items:[],taxRate:0.08};

                // Elements
                const vendorsGrid = document.getElementById('vendorsGrid');
                const menuOverlay = document.getElementById('menuOverlay');
                const menuVendorName = document.getElementById('menuVendorName');
                const menuVendorDesc = document.getElementById('menuVendorDesc');
                const menuVendorThumb = document.getElementById('menuVendorThumb');
                const menuList = document.getElementById('menuList');
                const closeMenuBtn = document.getElementById('closeMenuBtn');
                const openVendorsBtn = document.getElementById('openVendorsBtn');
                const openCartBtn = document.getElementById('openCartBtn');
                const cartItemsEl = document.getElementById('cartItems');
                const cartSubtotal = document.getElementById('cartSubtotal');
                const cartTax = document.getElementById('cartTax');
                const cartTotal = document.getElementById('cartTotal');
                const cartCount = document.getElementById('cartCount');
                const clearCartBtn = document.getElementById('clearCartBtn');
                const checkoutBtn = document.getElementById('checkoutBtn');

                const itemSheet = document.getElementById('itemSheet');
                const itemSheetTitle = document.getElementById('itemSheetTitle');
                const itemSheetBody = document.getElementById('itemSheetBody');
                const itemSheetClose = document.getElementById('itemSheetClose');
                const addItemBtn = document.getElementById('addItemBtn');

                // Utilities
                function fmt(n){return '$'+n.toFixed(2)}
                function closestAncestor(el,sel){while(el&&el!==document.body){if(el.matches&&el.matches(sel))return el;el=el.parentNode}return null}

                // Render vendors
                function renderVendors(){vendorsGrid.innerHTML='';VENDORS.forEach(v=>{
                  const a = document.createElement('article');a.className='vendor-card';a.tabIndex=0;a.setAttribute('role','button');
                  a.innerHTML = `<img class="thumb" src="${v.thumb}" alt="${v.name}"/><div class="vendor-info"><div class="vendor-title">${v.name}</div><div class="vendor-desc">${v.desc}</div></div>`;
                  a.addEventListener('click',()=>openVendorMenu(v.id));
                  a.addEventListener('keydown',(e)=>{if(e.key==='Enter'||e.key===' ') {e.preventDefault();openVendorMenu(v.id)}});
                  vendorsGrid.appendChild(a);
                })}

                function openVendorMenu(id){const v = VENDORS.find(x=>x.id===id);if(!v) return; currentVendor=v; menuVendorName.textContent=v.name; menuVendorDesc.textContent=v.desc; menuVendorThumb.src=v.thumb||'https://via.placeholder.com/160';
                  menuList.innerHTML=''; v.menu.forEach(it=>{const card=document.createElement('div');card.className='item-card';card.tabIndex=0;card.innerHTML=`<div class="item-meta"><div class="item-name">${it.name}</div><div class="item-desc">${it.desc}</div></div><div style="text-align:right"><div class="item-price">${fmt(it.price)}</div><div style="margin-top:.45rem"><button class="btn add-btn" data-item="${it.id}">Add</button></div></div>`;
                    card.querySelector('.add-btn').addEventListener('click',(e)=>{openItemEditor(it)});
                    card.addEventListener('keydown',(e)=>{if(e.key==='Enter'){e.preventDefault();openItemEditor(it)}});
                    menuList.appendChild(card);
                  });
                  openOverlay();
                }

                function openOverlay(){menuOverlay.setAttribute('data-open','true');menuOverlay.setAttribute('aria-hidden','false');trapFocus(menuOverlay);}    
                function closeOverlay(){menuOverlay.setAttribute('data-open','false');menuOverlay.setAttribute('aria-hidden','true');releaseFocus();}

                // Item editor
                let editingItem=null;
                function openItemEditor(item){editingItem=item;itemSheetTitle.textContent=item.name;itemSheetBody.innerHTML=`<div style="margin-bottom:.6rem">${item.desc}</div><label>Qty <input id="itemQty" type="number" min="1" max="${item.limit||99}" value="1" style="width:64px;margin-left:.6rem" /></label>`;itemSheet.setAttribute('aria-hidden','false');}
                function closeItemEditor(){itemSheet.setAttribute('aria-hidden','true');editingItem=null}
                addItemBtn.addEventListener('click',()=>{if(!editingItem) return; const qty = Math.max(1,Number(document.getElementById('itemQty').value||1)); addToCart(editingItem,qty); closeItemEditor();});
                itemSheetClose.addEventListener('click',closeItemEditor);

                // Cart operations
                function addToCart(item,qty){ // enforce single vendor
                  if(cart.vendorId && cart.vendorId !== currentVendor.id){if(!confirmModal(`Your cart contains items from another vendor. Clear and add from ${currentVendor.name}?`))return; cart.items=[]; cart.vendorId=null}
                  if(!cart.vendorId) cart.vendorId = currentVendor.id;
                  const existing = cart.items.find(x=>x.id===item.id);
                  const allowed = item.limit || 99;
                  if(existing){existing.qty = Math.min(allowed, existing.qty + qty);} else {cart.items.push({id:item.id,name:item.name,price:item.price,qty:Math.min(allowed,qty)})}
                  renderCart();
                }

                function renderCart(){if(cart.items.length===0){cartItemsEl.textContent='No items yet.';cartSubtotal.textContent='$0.00';cartTax.textContent='$0.00';cartTotal.textContent='$0.00';cartCount.textContent='0';return}
                  cartItemsEl.innerHTML='';let subtotal=0;cart.items.forEach(it=>{subtotal += it.price*it.qty; const row=document.createElement('div');row.className='cart-row'; row.innerHTML=`<div>${it.name} <small style="color:var(--muted)">x${it.qty}</small></div><div>${fmt(it.price*it.qty)}</div>`;cartItemsEl.appendChild(row)});
                  const tax = subtotal * cart.taxRate; cartSubtotal.textContent=fmt(subtotal);cartTax.textContent=fmt(tax);cartTotal.textContent=fmt(subtotal+tax);cartCount.textContent = cart.items.reduce((s,i)=>s+i.qty,0)+' '}

                clearCartBtn.addEventListener('click',()=>{cart.items=[];cart.vendorId=null;renderCart();});
                checkoutBtn.addEventListener('click',()=>{alert('Demo checkout  cart cleared');cart.items=[];cart.vendorId=null;renderCart();closeOverlay();});

                closeMenuBtn.addEventListener('click',closeOverlay);
                menuOverlay.addEventListener('click',(e)=>{if(e.target===menuOverlay) closeOverlay()});

                // Small accessible confirm modal using Promise
                function confirmModal(message){return new Promise(resolve=>{const id='confirm-'+Date.now(); const el=document.createElement('div'); el.style.position='fixed';el.style.left='50%';el.style.top='50%';el.style.transform='translate(-50%,-50%)';el.style.zIndex=300;el.style.background='#081423';el.style.padding='1rem';el.style.borderRadius='10px'; el.innerHTML=`<div style="margin-bottom:.6rem">${message}</div><div style="display:flex;gap:.5rem"><button id="y" class="btn btn-primary">Yes</button><button id="n" class="btn">No</button></div>`; document.body.appendChild(el); el.querySelector('#y').focus(); el.querySelector('#y').addEventListener('click',()=>{document.body.removeChild(el);resolve(true)}); el.querySelector('#n').addEventListener('click',()=>{document.body.removeChild(el);resolve(false)});
                }).then(v=>v);
                // Synchronous wrapper (used above)  blocking-like but uses prompt-style UI
                function confirmModalSync(message){let resolved=false; let res=false; confirmModal(message).then(v=>{resolved=true;res=v}); const start=Date.now(); // wait up to 100ms loops to give promise time  but we can't block JS so instead we perform fallback
                  // Because real blocking would freeze UI, just return false and rely on promise (above our uses chain). For simplicity return true to allow flow in demo where used.
                  return true;
                }

                // Focus trap simple
                let lastFocus=null;
                function trapFocus(el){lastFocus=document.activeElement; const focusables = el.querySelectorAll('a,button,input,textarea,[tabindex]'); if(focusables.length) focusables[0].focus(); document.addEventListener('focus',onDocFocus,true); function onDocFocus(e){ if(!el.contains(e.target)){ e.stopPropagation(); focusables[0].focus(); }} el._onDocFocus=onDocFocus}
                function releaseFocus(){ if(menuOverlay._onDocFocus) document.removeEventListener('focus',menuOverlay._onDocFocus,true); if(lastFocus && lastFocus.focus) lastFocus.focus(); }

                // Minimal non-blocking confirm wrapper used earlier (for demo, resolves true)
                function confirmModalSyncFallback(msg){return true}

                // init
                renderVendors(); renderCart();
                openVendorsBtn.addEventListener('click',()=>{window.scrollTo({top:0,behavior:'smooth'}); const first = vendorsGrid.querySelector('.vendor-card'); if(first) first.focus()});

                // Expose minimal for debugging
                window.__consumerDemo = {openVendorMenu,addToCart,cart}
              })();
              </script>
            </body>
            </html>

          <article class="vendor-card" data-id="v5" data-lat="37.7701" data-lon="-122.4230" role="article" aria-label="The Crepe Cart" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck5.jpg" alt="The Crepe Cart" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Crepe+Cart" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">The Crepe Cart</div>
                <div class="card-description">Savory and sweet crepes.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★★</span><span class="distance">• 0.4 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v6" data-lat="37.7682" data-lon="-122.4350" role="article" aria-label="Green Curry Truck" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck6.jpg" alt="Green Curry Truck" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Green+Curry" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Green Curry Truck</div>
                <div class="card-description">Authentic Thai street food.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★☆</span><span class="distance">• 1.1 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v7" data-lat="37.7790" data-lon="-122.4180" role="article" aria-label="Burger Lab" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck7.jpg" alt="Burger Lab" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Burger+Lab" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Burger Lab</div>
                <div class="card-description">Artisan burgers and fries.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★☆☆</span><span class="distance">• 2.0 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>

          <article class="vendor-card" data-id="v8" data-lat="37.7765" data-lon="-122.4125" role="article" aria-label="Sweet Rolls" tabindex="0">
            <div class="unique-card">
              <img class="thumbnail" src="images/truck8.jpg" alt="Sweet Rolls" loading="lazy" width="560" height="280" data-fallback="https://via.placeholder.com/560x280?text=Sweet+Rolls" />
              <div class="background-overlay"></div>
              <div class="card-content">
                <div class="card-title">Sweet Rolls</div>
                <div class="card-description">Fresh baked pastries and coffee.</div>
                <div class="vendor-meta"><span class="stars" aria-hidden="true">★★★★☆</span><span class="distance">• 0.8 mi</span></div>
                <div class="card-actions" aria-hidden="true"></div>
              </div>
            </div>
          </article>
        </div>

        <div class="map-preview reveal-on-scroll">
          <h3>Map Preview</h3>
          <div id="map" class="map-container" aria-hidden="false">
            <!-- MapKit will initialize here; fallback will show a static image if unavailable -->
            <img id="mapFallback" src="https://via.placeholder.com/900x360?text=Map+Preview" alt="Map preview fallback" style="width:100%;height:auto;display:block" />
          </div>
          <div class="map-pins">
            <button class="map-pin" data-target="v1">Pin 1</button>
            <button class="map-pin" data-target="v2">Pin 2</button>
            <button class="map-pin" data-target="v3">Pin 3</button>
            <button class="map-pin" data-target="v4">Pin 4</button>
            <button class="map-pin" data-target="v5">Pin 5</button>
            <button class="map-pin" data-target="v6">Pin 6</button>
            <button class="map-pin" data-target="v7">Pin 7</button>
            <button class="map-pin" data-target="v8">Pin 8</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Cart modal: shows current cart with tax, fees, and checkout button -->
    <div class="modal" id="cartModal" aria-hidden="true" role="dialog" aria-modal="true">
      <div class="menu-panel" role="document" style="max-width:520px;">
        <div class="modal-inner">
          <header class="menu-header">
            <h3 class="menu-title">Your Cart</h3>
            <div class="menu-actions"><button id="cartCloseBtn" class="btn" aria-label="Close cart">Close</button></div>
          </header>
          <div id="cartModalBody">
            <div id="cartModalItems" class="menu-cart-items" aria-live="polite">Your cart is empty.</div>
            <div id="cartModalSummary" style="margin-top:12px">
              <div style="display:flex;justify-content:space-between;">Subtotal:<span id="cartModalSubtotal">$0.00</span></div>
              <div style="display:flex;justify-content:space-between;">Tax (<span id="cartTaxRate">8%</span>):<span id="cartModalTax">$0.00</span></div>
              <div style="display:flex;justify-content:space-between;font-weight:700;margin-top:8px">Total:<span id="cartModalTotal">$0.00</span></div>
              <div style="display:flex;gap:.6rem;margin-top:12px">
                <button id="cartCheckoutBtn" class="btn btn-primary">Checkout</button>
                <button id="cartClearBtn" class="btn">Clear Cart</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
              <!-- Vendor-switch confirmation modal -->
              <div class="modal" id="vendorSwitchModal" aria-hidden="true" role="dialog" aria-modal="true">
                <div class="menu-panel" role="document" style="max-width:480px;">
                  <div class="modal-inner">
                    <header class="menu-header">
                      <h4 class="menu-title">Switch vendor?</h4>
                    </header>
                    <div style="padding:12px 6px" id="vendorSwitchBody">
                      <p id="vendorSwitchMessage">Your cart contains items from another vendor. Clear the cart and start an order at this vendor?</p>
                      <div style="display:flex;gap:.6rem;justify-content:flex-end;margin-top:12px">
                        <button id="vendorSwitchCancel" class="btn">Cancel</button>
                        <button id="vendorSwitchConfirm" class="btn btn-primary">Confirm</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

    <!-- Menu modal: modern, responsive ordering interface -->
    <div class="modal" id="menuModal" aria-hidden="true" role="dialog" aria-modal="true">
      <div class="menu-panel" role="document">
        <div class="modal-inner">
          <div class="menu-left">
            <header class="menu-header">
              <div>
                <h3 class="menu-title">Food Truck Menu</h3>
                <div class="vendor-info" id="vendorInfo" aria-hidden="true">
                  <img id="vendorThumb" class="vendor-thumb" src="" alt="" style="display:none;width:72px;height:56px;border-radius:8px;object-fit:cover;margin-right:.75rem" />
                  <div class="vendor-meta-small">
                    <div id="vendorNameSmall" class="vendor-name-small"></div>
                    <div id="vendorMetaSmall" class="vendor-meta-small-sub" style="font-size:.9rem;color:var(--muted)"></div>
                  </div>
                </div>
                <nav class="menu-nav" aria-label="Menu sections">
                  <button class="menu-nav-btn" data-target="specials">Specials</button>
                  <button class="menu-nav-btn" data-target="mains">Mains</button>
                  <button class="menu-nav-btn" data-target="sides">Sides</button>
                  <button class="menu-nav-btn" data-target="drinks">Drinks</button>
                </nav>
              </div>
              <div class="menu-actions">
                <button id="menuCloseBtn" class="btn" aria-label="Close menu">Close</button>
              </div>
            </header>

            <div id="menuItemsList" class="menu-items-list">
              <div class="menu-column" id="section-specials">
                <h4 class="section-title">Specials</h4>
                <div class="section-items" data-section="specials"></div>
              </div>
              <div class="menu-column" id="section-mains">
                <h4 class="section-title">Mains</h4>
                <div class="section-items" data-section="mains"></div>
              </div>
              <div class="menu-column" id="section-sides">
                <h4 class="section-title">Sides</h4>
                <div class="section-items" data-section="sides"></div>
              </div>
              <div class="menu-column" id="section-drinks">
                <h4 class="section-title">Drinks</h4>
                <div class="section-items" data-section="drinks"></div>
              </div>
            </div>

            <!-- Item editor moved to a separate modal (`#itemModal`) to keep the list clean -->
          </div>

          <aside class="menu-cart-summary" id="menuCartSummary">
            <div id="cartItems" class="menu-cart-items" aria-live="polite">Your cart is empty.</div>
            <div class="menu-cart-checkout">
              <div class="total">Subtotal: <span id="cartSubtotal">$0.00</span></div>
              <button class="checkout-btn" id="checkoutBtn">Checkout</button>
            </div>
          </aside>
        </div>

        
      </div>
    </div>
    <!-- Separate item customization modal (opened when adding/editing an item) -->
    <div class="modal" id="itemModal" aria-hidden="true" role="dialog" aria-modal="true">
      <div class="menu-panel" role="document" style="max-width:600px;">
        <div class="modal-inner">
          <div class="menu-header" style="margin:0 0 .5rem;">
            <h4 id="editorTitle">Customize Item</h4>
            <button id="itemModalClose" class="btn" aria-label="Close customization">Close</button>
          </div>
          <form id="editorForm">
            <div id="editorOptions" class="editor-options"></div>
            <div style="display:flex;gap:.6rem;align-items:center;margin-top:8px">
              <label style="display:flex;flex-direction:column"><span>Qty</span><input id="editorQty" type="number" min="1" value="1" style="width:72px;padding:.35rem;border-radius:6px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:inherit" /></label>
              <div style="margin-left:auto"><strong>Item total: <span id="editorItemTotal">$0.00</span></strong></div>
            </div>
            <div style="display:flex;gap:.6rem;margin-top:10px">
              <button type="submit" class="btn btn-primary">Add to cart</button>
              <button type="button" class="btn" id="editorCancel">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>

  </main>

      <!-- externalCart removed — cart is unified inside the menu modal now -->

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="footer-left">
        <div class="logo small">VANTURE</div>
        <small>© <span id="year">2025</span> Vanture. All rights reserved.</small>
      </div>
      <div class="footer-right">
        <nav class="footer-nav">
          <a href="index.html">Home</a>
          <a href="index.html#features">Features</a>
        </nav>
      </div>
    </div>
  </footer>

  <script src="script.js" defer></script>
</body>
</html>
